<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>U.S. Treasury Yield Curves</title>
</head>
<body>
<div style="width: 100%; height: 100%">
<canvas id="canvas"></canvas>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script> 

let ctx = document.getElementById("canvas")

let chart = new Chart(ctx, {
    type: "line",
    data: {
        // labels: ["1M", "3M", "6M", "1Y", "2Y", "3Y", "5Y", "7Y", "10Y", "20Y", "30Y"],
        datasets: []
    },
    options: {
        scales: {
            y: {
                min: 0,
                max: 6,
                ticks: {
                    callback: (val, idx, _) => val + "%",
                }
            }
        }
    },
})

async function add(maturity, color) {
    let res = await fetch("data.php?maturity=" + maturity)
    let csv = await res.text()
    let rows = csv.split("\n").slice(1, -1).map(l => l.split(","))
    let dates = rows.map(r => r[0])
    let yields = rows.map(r => r[1] == "" ? null : parseFloat(r[1]))
    chart.data.labels = dates
    chart.data.datasets.push({label: maturity + "Y", borderColor: color, data: yields})
    chart.update()
}

// "1MO", "3MO", "6MO", "1", "2", "3", "5", "7", "10", "20", "30"
add("1", "red")
add("3", "blue")
add("5", "green")
add("10", "orange")

</script>
</body>
</html>
